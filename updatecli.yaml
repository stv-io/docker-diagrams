name: Update diagrams version

autodiscovery:
  scmid: default
  crawlers:
    dockerfile:
    github/action:

scms:
  default:
    kind: github
    spec:
      email: "updatecli-bot@sanctions.io"
      owner: "stv-io"
      token: '{{ requiredEnv "GITHUB_TOKEN" }}'
      username: '{{ requiredEnv "GITHUB_USERNAME" }}'
      repository: "docker-diagrams"
      branch: "master"

sources:
  diagrams:
    kind: githubrelease
    spec:
      owner: mingrammer
      repository: diagrams
      token: '{{ requiredEnv "GITHUB_TOKEN" }}'

targets:
  version.txt:
    name: Update version.txt
    kind: file
    sourceid: diagrams
    scmid: default
    spec:
      file: version.txt
      matchpattern: .*
      replacepattern: '{{ source "diagrams" }}'
      forcecreate: true

actions:
  default:
    kind: github/pullrequest
    scmid: default
    spec:
      title: "chore: Update diagrams version"
      description: |
        This PR was automatically generated by Updatecli.

        It updates diagrams to the latest available release version.
      mergemethod: squash
      labels:
        - diagrams